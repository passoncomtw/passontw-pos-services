<?xml version="1.0" encoding="UTF-8"?>
<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 0 1000 850">
  <defs>
    <style>
      @import url('https://fonts.googleapis.com/css2?family=Noto+Sans+TC:wght@400;500;700&amp;display=swap');
      
      .title {
        font-family: 'Noto Sans TC', sans-serif;
        font-size: 28px;
        font-weight: 700;
        fill: #2D3748;
      }
      .section-title {
        font-family: 'Noto Sans TC', sans-serif;
        font-size: 20px;
        font-weight: 600;
        fill: #2D3748;
      }
      .component {
        font-family: 'Noto Sans TC', sans-serif;
        font-size: 15px;
        font-weight: 500;
        fill: #2D3748;
      }
      .note {
        font-family: 'Noto Sans TC', sans-serif;
        font-size: 13px;
        fill: #4A5568;
        font-style: italic;
      }
      .arrow {
        stroke: #4A5568;
        stroke-width: 2.5;
        fill: none;
        marker-end: url(#arrowhead);
      }
      .dash-arrow {
        stroke: #718096;
        stroke-width: 2;
        stroke-dasharray: 6,4;
        fill: none;
        marker-end: url(#arrowhead-light);
      }
      .box {
        stroke-width: 2;
        filter: drop-shadow(3px 3px 4px rgba(0, 0, 0, 0.15));
      }
      .client-box {
        stroke: #2C5282;
        stroke-width: 2;
        fill: #EBF8FF;
        rx: 8;
        ry: 8;
        filter: drop-shadow(3px 3px 4px rgba(44, 82, 130, 0.2));
      }
      .server-box {
        stroke: #2D3748;
        stroke-width: 2;
        fill: #F7FAFC;
        rx: 8;
        ry: 8;
        filter: drop-shadow(3px 3px 4px rgba(45, 55, 72, 0.2));
      }
      .database-box {
        stroke: #38A169;
        stroke-width: 2;
        fill: #F0FFF4;
        rx: 8;
        ry: 8;
        filter: drop-shadow(3px 3px 4px rgba(56, 161, 105, 0.2));
      }
      .queue-box {
        stroke: #DD6B20;
        stroke-width: 2;
        fill: #FFFAF0;
        rx: 8;
        ry: 8;
        filter: drop-shadow(3px 3px 4px rgba(221, 107, 32, 0.2));
      }
      .hardware-box {
        stroke: #E53E3E;
        stroke-width: 2;
        fill: #FFF5F5;
        rx: 8;
        ry: 8;
        filter: drop-shadow(3px 3px 4px rgba(229, 62, 62, 0.2));
      }
      .monitoring-box {
        stroke: #805AD5;
        stroke-width: 2;
        fill: #FAF5FF;
        rx: 8;
        ry: 8;
        filter: drop-shadow(3px 3px 4px rgba(128, 90, 213, 0.2));
      }
      .layer {
        stroke: #CBD5E0;
        stroke-width: 2;
        fill: rgba(247, 250, 252, 0.6);
        rx: 12;
        ry: 12;
      }
      .legend-box {
        stroke: #E2E8F0;
        stroke-width: 2;
        fill: rgba(255, 255, 255, 0.9);
        rx: 8;
        ry: 8;
        filter: drop-shadow(2px 2px 3px rgba(0, 0, 0, 0.1));
      }
      .layer-label {
        font-family: 'Noto Sans TC', sans-serif;
        font-size: 15px;
        font-weight: 600;
        fill: white;
      }
      .layer-badge {
        fill: #4A5568;
        rx: 4;
        ry: 4;
      }
      .icon {
        fill: #2D3748;
      }
      .gradient-bg {
        fill: url(#headerGradient);
      }
    </style>
    
    <linearGradient id="headerGradient" x1="0%" y1="0%" x2="100%" y2="0%">
      <stop offset="0%" style="stop-color:#2C5282;stop-opacity:1" />
      <stop offset="100%" style="stop-color:#4299E1;stop-opacity:1" />
    </linearGradient>
    
    <marker id="arrowhead" markerWidth="10" markerHeight="7" refX="9" refY="3.5" orient="auto">
      <polygon points="0 0, 10 3.5, 0 7" fill="#4A5568"/>
    </marker>
    
    <marker id="arrowhead-light" markerWidth="10" markerHeight="7" refX="9" refY="3.5" orient="auto">
      <polygon points="0 0, 10 3.5, 0 7" fill="#718096"/>
    </marker>
    
    <!-- Icons -->
    <symbol id="icon-client" viewBox="0 0 24 24">
      <path d="M20 4H4c-1.1 0-1.99.9-1.99 2L2 18c0 1.1.9 2 2 2h16c1.1 0 2-.9 2-2V6c0-1.1-.9-2-2-2zm-5 14H4v-4h11v4zm0-5H4V9h11v4zm5 5h-4V9h4v9z"/>
    </symbol>
    
    <symbol id="icon-server" viewBox="0 0 24 24">
      <path d="M20 2H4c-1.1 0-2 .9-2 2v6c0 1.1.9 2 2 2h16c1.1 0 2-.9 2-2V4c0-1.1-.9-2-2-2zm0 8H4V4h16v6zM4 14h16c1.1 0 2 .9 2 2v4c0 1.1-.9 2-2 2H4c-1.1 0-2-.9-2-2v-4c0-1.1.9-2 2-2zm0 6h16v-4H4v4z"/>
    </symbol>
    
    <symbol id="icon-database" viewBox="0 0 24 24">
      <path d="M12 2C6.48 2 2 4.02 2 6.5v11C2 19.98 6.48 22 12 22s10-2.02 10-4.5v-11C22 4.02 17.52 2 12 2zm0 2c4.42 0 8 1.34 8 3s-3.58 3-8 3-8-1.34-8-3 3.58-3 8-3zm0 16c-4.42 0-8-1.34-8-3v-3.63c1.54.92 4.3 1.63 8 1.63s6.46-.71 8-1.63V17c0 1.66-3.58 3-8 3zm0-5c-4.42 0-8-1.34-8-3v-3.71c1.54.92 4.3 1.71 8 1.71s6.46-.79 8-1.71V12c0 1.66-3.58 3-8 3z"/>
    </symbol>
    
    <symbol id="icon-queue" viewBox="0 0 24 24">
      <path d="M4 18h16c.55 0 1-.45 1-1s-.45-1-1-1H4c-.55 0-1 .45-1 1s.45 1 1 1zm0-5h16c.55 0 1-.45 1-1s-.45-1-1-1H4c-.55 0-1 .45-1 1s.45 1 1 1zM3 7c0 .55.45 1 1 1h16c.55 0 1-.45 1-1s-.45-1-1-1H4c-.55 0-1 .45-1 1z"/>
    </symbol>
    
    <symbol id="icon-hardware" viewBox="0 0 24 24">
      <path d="M19 8h-1V3H6v5H5c-1.66 0-3 1.34-3 3v6h4v4h12v-4h4v-6c0-1.66-1.34-3-3-3zm-3 11H8v-4h8v4zm0-11H8V5h8v3zm2 4.5c-.55 0-1-.45-1-1s.45-1 1-1 1 .45 1 1-.45 1-1 1z"/>
    </symbol>
    
    <symbol id="icon-monitoring" viewBox="0 0 24 24">
      <path d="M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zM9 17H7v-7h2v7zm4 0h-2V7h2v10zm4 0h-2v-4h2v4z"/>
    </symbol>
  </defs>
  
  <!-- Header Background -->
  <rect x="0" y="0" width="1000" height="60" class="gradient-bg"/>
  
  <!-- Title -->
  <text x="500" y="40" class="title" text-anchor="middle" fill="white">POS系統完整服務架構圖</text>
  
  <!-- Legend -->
  <rect x="790" y="15" width="190" height="30" rx="15" ry="15" fill="rgba(255,255,255,0.8)"/>
  <text x="810" y="35" class="note" style="font-style: normal; fill: #2D3748; font-weight: 600;">高效能 · 多租戶 · 可擴展</text>
  
  <rect x="800" y="70" width="180" height="215" class="legend-box"/>
  <text x="890" y="90" class="component" text-anchor="middle" style="font-weight: 600;">圖例說明</text>
  
  <rect x="810" y="105" width="20" height="15" class="client-box"/>
  <text x="855" y="117" class="note" style="font-style: normal;">客戶端元件</text>
  
  <rect x="810" y="130" width="20" height="15" class="server-box"/>
  <text x="855" y="142" class="note" style="font-style: normal;">服務器元件</text>
  
  <rect x="810" y="155" width="20" height="15" class="database-box"/>
  <text x="855" y="167" class="note" style="font-style: normal;">數據存儲元件</text>
  
  <rect x="810" y="180" width="20" height="15" class="queue-box"/>
  <text x="855" y="192" class="note" style="font-style: normal;">消息隊列元件</text>
  
  <rect x="810" y="205" width="20" height="15" class="hardware-box"/>
  <text x="855" y="217" class="note" style="font-style: normal;">硬體設備</text>
  
  <rect x="810" y="230" width="20" height="15" class="monitoring-box"/>
  <text x="855" y="242" class="note" style="font-style: normal;">監控與日誌</text>
  
  <line x1="820" y1="260" x2="850" y2="260" class="arrow"/>
  <text x="880" y="265" class="note" style="font-style: normal;">直接連接</text>
  
  <line x1="820" y1="280" x2="850" y2="280" class="dash-arrow"/>
  <text x="880" y="285" class="note" style="font-style: normal;">間接連接</text>
  
  <!-- Client Layer -->
  <rect x="50" y="70" width="730" height="120" class="layer"/>
  <rect x="50" y="70" width="140" height="30" class="layer-badge"/>
  <text x="120" y="90" class="layer-label" text-anchor="middle">客戶端層</text>
  
  <rect x="90" y="105" width="180" height="70" class="client-box box"/>
  <use xlink:href="#icon-client" x="100" y="115" width="24" height="24" class="icon"/>
  <text x="180" y="130" class="component" text-anchor="middle">店家前端操作介面</text>
  <text x="180" y="150" class="note" text-anchor="middle">React + 觸控優化</text>
  
  <rect x="300" y="105" width="180" height="70" class="client-box box"/>
  <use xlink:href="#icon-client" x="310" y="115" width="24" height="24" class="icon"/>
  <text x="390" y="130" class="component" text-anchor="middle">後台管理介面</text>
  <text x="390" y="150" class="note" text-anchor="middle">React + Material Dashboard</text>
  
  <rect x="510" y="105" width="180" height="70" class="client-box box"/>
  <use xlink:href="#icon-client" x="520" y="115" width="24" height="24" class="icon"/>
  <text x="600" y="130" class="component" text-anchor="middle">安卓平板設備</text>
  <text x="600" y="150" class="note" text-anchor="middle">觸控螢幕 + 專用支架</text>
  
  <!-- API Gateway Layer -->
  <rect x="50" y="220" width="730" height="80" class="layer"/>
  <rect x="50" y="220" width="140" height="30" class="layer-badge"/>
  <text x="120" y="240" class="layer-label" text-anchor="middle">API閘道層</text>
  
  <rect x="215" y="245" width="400" height="40" class="server-box box"/>
  <use xlink:href="#icon-server" x="225" y="252" width="24" height="24" class="icon"/>
  <text x="415" y="270" class="component" text-anchor="middle">API Gateway (HTTPS + SSL)</text>
  
  <!-- Backend Services Layer -->
  <rect x="50" y="330" width="900" height="150" class="layer"/>
  <rect x="50" y="330" width="160" height="30" class="layer-badge"/>
  <text x="130" y="350" class="layer-label" text-anchor="middle">後端服務層 (Golang)</text>
  
  <rect x="100" y="370" width="120" height="60" class="server-box box"/>
  <text x="160" y="400" class="component" text-anchor="middle">認證授權服務</text>
  <text x="160" y="415" class="note" text-anchor="middle">JWT</text>
  
  <rect x="240" y="370" width="120" height="60" class="server-box box"/>
  <text x="300" y="400" class="component" text-anchor="middle">使用者管理</text>
  <text x="300" y="415" class="note" text-anchor="middle">員工/權限</text>
  
  <rect x="380" y="370" width="120" height="60" class="server-box box"/>
  <text x="440" y="400" class="component" text-anchor="middle">菜單管理</text>
  <text x="440" y="415" class="note" text-anchor="middle">商品/分類</text>
  
  <rect x="520" y="370" width="120" height="60" class="server-box box"/>
  <text x="580" y="400" class="component" text-anchor="middle">訂單處理</text>
  <text x="580" y="415" class="note" text-anchor="middle">點餐/結帳</text>
  
  <rect x="660" y="370" width="120" height="60" class="server-box box"/>
  <text x="720" y="400" class="component" text-anchor="middle">設備整合</text>
  <text x="720" y="415" class="note" text-anchor="middle">出單機驅動</text>
  
  <rect x="800" y="370" width="120" height="60" class="server-box box"/>
  <text x="860" y="400" class="component" text-anchor="middle">店家管理</text>
  <text x="860" y="415" class="note" text-anchor="middle">多租戶支援</text>
  
  <!-- Data Storage Layer -->
  <rect x="50" y="510" width="430" height="130" class="layer"/>
  <rect x="50" y="510" width="140" height="30" class="layer-badge"/>
  <text x="120" y="530" class="layer-label" text-anchor="middle">數據存儲層</text>
  
  <rect x="100" y="550" width="160" height="70" class="database-box box"/>
  <use xlink:href="#icon-database" x="110" y="560" width="24" height="24" class="icon"/>
  <text x="180" y="580" class="component" text-anchor="middle">PostgreSQL</text>
  <text x="180" y="600" class="note" text-anchor="middle">主要數據存儲</text>
  
  <rect x="280" y="550" width="160" height="70" class="database-box box"/>
  <use xlink:href="#icon-database" x="290" y="560" width="24" height="24" class="icon"/>
  <text x="360" y="580" class="component" text-anchor="middle">Redis</text>
  <text x="360" y="600" class="note" text-anchor="middle">緩存/會話管理</text>
  
  <!-- Message Queue Layer -->
  <rect x="510" y="510" width="230" height="130" class="layer"/>
  <rect x="510" y="510" width="140" height="30" class="layer-badge"/>
  <text x="580" y="530" class="layer-label" text-anchor="middle">消息隊列層</text>
  
  <rect x="540" y="550" width="170" height="70" class="queue-box box"/>
  <use xlink:href="#icon-queue" x="550" y="560" width="24" height="24" class="icon"/>
  <text x="625" y="580" class="component" text-anchor="middle">NATS</text>
  <text x="625" y="600" class="note" text-anchor="middle">事件驅動/異步處理</text>
  
  <!-- Hardware Layer -->
  <rect x="50" y="670" width="430" height="110" class="layer"/>
  <rect x="50" y="670" width="140" height="30" class="layer-badge"/>
  <text x="120" y="690" class="layer-label" text-anchor="middle">硬體設備層</text>
  
  <rect x="80" y="700" width="150" height="60" class="hardware-box box"/>
  <use xlink:href="#icon-hardware" x="90" y="710" width="24" height="24" class="icon"/>
  <text x="155" y="730" class="component" text-anchor="middle">CP-Q3X感熱式出單機</text>
  <text x="155" y="745" class="note" text-anchor="middle">廚房出單/客戶收據</text>
  
  <rect x="250" y="700" width="150" height="60" class="hardware-box box"/>
  <use xlink:href="#icon-hardware" x="260" y="710" width="24" height="24" class="icon"/>
  <text x="325" y="730" class="component" text-anchor="middle">錢箱</text>
  <text x="325" y="745" class="note" text-anchor="middle">自動開啟</text>
  
  <!-- Monitoring Layer -->
  <rect x="510" y="670" width="330" height="110" class="layer"/>
  <rect x="510" y="670" width="155" height="30" class="layer-badge"/>
  <text x="587" y="690" class="layer-label" text-anchor="middle">監控與日誌層</text>
  
  <rect x="530" y="700" width="120" height="60" class="monitoring-box box"/>
  <use xlink:href="#icon-monitoring" x="540" y="710" width="24" height="24" class="icon"/>
  <text x="590" y="730" class="component" text-anchor="middle">Prometheus</text>
  <text x="590" y="745" class="note" text-anchor="middle">性能監控</text>
  
  <rect x="670" y="700" width="120" height="60" class="monitoring-box box"/>
  <use xlink:href="#icon-monitoring" x="680" y="710" width="24" height="24" class="icon"/>
  <text x="730" y="730" class="component" text-anchor="middle">ELK/Loki</text>
  <text x="730" y="745" class="note" text-anchor="middle">日誌管理</text>
  
  <!-- 4G/5G Router (moved to free space) -->
  <rect x="765" y="550" width="150" height="60" class="hardware-box box"/>
  <use xlink:href="#icon-hardware" x="775" y="560" width="24" height="24" class="icon"/>
  <text x="840" y="580" class="component" text-anchor="middle">備用網路設備</text>
  <text x="840" y="595" class="note" text-anchor="middle">4G/5G路由器</text>
  
  <!-- Connections -->
  <!-- Client to API Gateway -->
  <path d="M180,175 C180,200 190,220 280,245" class="arrow"/>
  <path d="M390,175 C390,200 390,220 415,245" class="arrow"/>
  <path d="M600,175 C600,200 550,220 500,245" class="arrow"/>
  
  <!-- API Gateway to Backend -->
  <path d="M415,285 L415,330" class="arrow"/>
  <path d="M315,285 C240,290 210,290 160,370" class="arrow"/>
  <path d="M365,285 C340,290 320,300 300,370" class="arrow"/>
  <path d="M395,285 C410,290 420,320 440,370" class="arrow"/>
  <path d="M435,285 C470,290 500,320 580,370" class="arrow"/>
  <path d="M465,285 C530,290 600,300 720,370" class="arrow"/>
  <path d="M515,285 C600,290 750,290 860,370" class="arrow"/>
  
  <!-- Backend to Data Storage -->
  <path d="M160,430 C160,460 160,480 180,550" class="arrow"/>
  <path d="M300,430 C300,460 270,500 180,550" class="arrow"/>
  <path d="M440,430 C440,460 400,500 360,550" class="arrow"/>
  <path d="M580,430 C500,460 440,500 360,550" class="arrow"/>
  <path d="M720,430 C650,450 540,470 180,550" class="dash-arrow"/>
  <path d="M860,430 C780,450 600,480 180,550" class="dash-arrow"/>
  
  <!-- Backend to Message Queue -->
  <path d="M580,430 C580,460 590,500 625,550" class="arrow"/>
  <path d="M720,430 C700,460 670,500 625,550" class="arrow"/>
  <path d="M300,430 C300,440 450,450 625,550" class="dash-arrow"/>
  <path d="M860,430 C800,450 700,500 625,550" class="dash-arrow"/>
  
  <!-- Backend to Hardware -->
  <path d="M720,430 C650,550 350,650 155,700" class="arrow"/>
  <path d="M580,430 C540,550 450,600 325,700" class="dash-arrow"/>
  <path d="M860,430 C850,480 845,500 840,550" class="arrow"/>
  
  <!-- Backend to Monitoring -->
  <path d="M160,430 C160,550 350,600 590,700" class="dash-arrow"/>
  <path d="M580,430 C580,550 600,620 590,700" class="dash-arrow"/>
  <path d="M860,430 C800,550 750,650 730,700" class="dash-arrow"/>
</svg>